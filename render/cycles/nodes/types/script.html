

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Script Node &mdash; Blender参考手册</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../../_static/css/theme_overrides.css" type="text/css" />
  

  
    <link rel="top" title="Blender参考手册" href="../../../../index.html"/>
        <link rel="up" title="Types" href="index.html"/>
        <link rel="next" title="World" href="../../world.html"/>
        <link rel="prev" title="Wavelength" href="converter/wavelength.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../contents.html" class="icon icon-home"> Blender 2.77 手册
          

          
            
            <img src="../../../../_static/sidebar_logo.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="查找文献" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/index.html">入门指南</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../interface/index.html">界面</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../editors/index.html">编辑器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../data_system/index.html">数据系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modeling/index.html">建模</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../painting_sculpting/index.html">绘制与雕刻</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../rigging/index.html">骨骼装配</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../animation/index.html">动画</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics/index.html">物理</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">渲染</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../introduction.html">简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blender_render/index.html">Blender渲染引擎</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Cycles渲染引擎</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../introduction.html">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../settings/index.html">渲染 设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../materials/index.html">Materials</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">节点</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../introduction.html">简介</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../world.html">World</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lamps.html">Lamps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../camera.html">相机</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reducing_noise.html">Reducing Noise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../features.html">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gpu_rendering.html">GPU 渲染ing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../osl.html">Open Shading Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../baking.html">渲染 Baking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../output/index.html">渲染输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../post_process/index.html">Post Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../freestyle/index.html">Freestyle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../workflows/index.html">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../opengl.html">OpenGL 渲染</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../compositing/index.html">合成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../game_engine/index.html">游戏引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../preferences/index.html">用户首选项</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../advanced/index.html">高级应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../troubleshooting/index.html">问题排查</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary/index.html">术语</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../about/index.html">关于本手册</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../contents.html">Blender 2.77 手册</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../contents.html">文献</a> &raquo;</li>
      
          <li><a href="../../../index.html">渲染</a> &raquo;</li>
      
          <li><a href="../../index.html">Cycles渲染引擎</a> &raquo;</li>
      
          <li><a href="../index.html">节点</a> &raquo;</li>
      
          <li><a href="index.html">Types</a> &raquo;</li>
      
    <li>Script Node</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/render/cycles/nodes/types/script.txt" rel="nofollow"> 查看页面源码</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="script-node">
<h1>Script Node<a class="headerlink" href="#script-node" title="Permalink to this headline">¶</a></h1>
<p>OSL was designed for node-based shading,
and <em>each</em> OSL shader corresponds to <em>one</em> node in a node setup. To add an OSL shader,
add a script node and link it to a text data-block or an external file. 输入 and output
sockets will be created from the shader parameters on clicking the update button in the node
or the text editor.</p>
<p>OSL shaders can be linked to the node in a few different ways. With the <em>Internal</em> mode,
a text data-block is used to store the OSL shader,
and the OSO bytecode is stored in the node itself.
This is useful for distributing a blend-file with everything packed into it.</p>
<p>The <em>External</em> mode can be used to specify a .osl file on disk,
and this will then be automatically compiled into a .oso file in the same directory.
It is also possible to specify a path to a .oso file, which will then be used directly,
with compilation done manually by the user.
The third option is to specify just the module name,
which will be looked up in the shader search path.</p>
<p>The shader search path is located in the same place as the scripts or configuration path,
under:</p>
<dl class="docutils">
<dt>Linux</dt>
<dd><pre class="first last literal-block">
$HOME/.config/blender/2.77/shaders/
</pre>
</dd>
<dt>MS-Windows</dt>
<dd><pre class="first last literal-block">
C:\Users\$user\AppData\Roaming\Blender Foundation\Blender\2.77\shaders\
</pre>
</dd>
<dt>Mac OSX</dt>
<dd><pre class="first last literal-block">
/Users/$USER/Library/Application Support/Blender/2.77/shaders/
</pre>
</dd>
</dl>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For use in production, we suggest to use a node group to wrap shader script nodes,
and link that into other blend-files.
This makes it easier to make changes to the node afterwards as sockets are added or removed,
without having to update the script nodes in all files.</p>
</div>
<div class="section" id="writing-shaders">
<h2>Writing Shaders<a class="headerlink" href="#writing-shaders" title="Permalink to this headline">¶</a></h2>
<p>For more details on how to write shaders, see the
<a class="reference external" href="https://github.com/imageworks/OpenShadingLanguage/blob/master/src/doc/osl-languagespec.pdf">OSL specification</a>.
Here is a simple example:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">shader</span> <span class="nf">simple_material</span><span class="p">(</span>
    <span class="n">color</span> <span class="n">Diffuse_Color</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
    <span class="kt">float</span> <span class="n">Noise_Factor</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">output</span> <span class="n">closure</span> <span class="n">color</span> <span class="n">BSDF</span> <span class="o">=</span> <span class="n">diffuse</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">color</span> <span class="n">material_color</span> <span class="o">=</span> <span class="n">Diffuse_Color</span> <span class="o">*</span> <span class="n">mix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">noise</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">),</span> <span class="n">Noise_Factor</span><span class="p">);</span>
    <span class="n">BSDF</span> <span class="o">=</span> <span class="n">material_color</span> <span class="o">*</span> <span class="n">diffuse</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="closures">
<h2>Closures<a class="headerlink" href="#closures" title="Permalink to this headline">¶</a></h2>
<p>OSL is different from, for example, RSL or GLSL, in that it does not have a light loop.
There is no access to lights in the scene,
and the material must be built from closures that are implemented in the render engine itself.
This is more limited, but also makes it possible for the render engine to do optimizations and
ensure all shaders can be importance sampled.</p>
<p>The available closures in Cycles correspond to the shader nodes and their sockets;
for more details on what they do and the meaning of the parameters,
see the <a class="reference internal" href="shaders/index.html"><span class="doc">shader nodes manual</span></a>.</p>
<div class="section" id="bsdf">
<h3>BSDF<a class="headerlink" href="#bsdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">diffuse(N)</span></code></li>
<li><code class="docutils literal"><span class="pre">oren_nayar(N,</span> <span class="pre">roughness)</span></code></li>
<li><code class="docutils literal"><span class="pre">diffuse_ramp(N,</span> <span class="pre">colors[8])</span></code></li>
<li><code class="docutils literal"><span class="pre">phong_ramp(N,</span> <span class="pre">exponent,</span> <span class="pre">colors[8])</span></code></li>
<li><code class="docutils literal"><span class="pre">diffuse_toon(N,</span> <span class="pre">size,</span> <span class="pre">smooth)</span></code></li>
<li><code class="docutils literal"><span class="pre">glossy_toon(N,</span> <span class="pre">size,</span> <span class="pre">smooth)</span></code></li>
<li><code class="docutils literal"><span class="pre">translucent(N)</span></code></li>
<li><code class="docutils literal"><span class="pre">reflection(N)</span></code></li>
<li><code class="docutils literal"><span class="pre">refraction(N,</span> <span class="pre">ior)</span></code></li>
<li><code class="docutils literal"><span class="pre">transparent()</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_ggx(N,</span> <span class="pre">roughness)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_ggx_aniso(N,</span> <span class="pre">T,</span> <span class="pre">ax,</span> <span class="pre">ay)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_ggx_refraction(N,</span> <span class="pre">roughness,</span> <span class="pre">ior)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_beckmann(N,</span> <span class="pre">roughness)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_beckmann_aniso(N,</span> <span class="pre">T,</span> <span class="pre">ax,</span> <span class="pre">ay)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_beckmann_refraction(N,</span> <span class="pre">roughness,</span> <span class="pre">ior)</span></code></li>
<li><code class="docutils literal"><span class="pre">ashikhmin_shirley(N,</span> <span class="pre">T,</span> <span class="pre">ax,</span> <span class="pre">ay)</span></code></li>
<li><code class="docutils literal"><span class="pre">ashikhmin_velvet(N,</span> <span class="pre">roughness)</span></code></li>
</ul>
</div>
<div class="section" id="hair">
<h3>Hair<a class="headerlink" href="#hair" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">hair_reflection(N,</span> <span class="pre">roughnessu,</span> <span class="pre">roughnessv,</span> <span class="pre">T,</span> <span class="pre">offset)</span></code></li>
<li><code class="docutils literal"><span class="pre">hair_transmission(N,</span> <span class="pre">roughnessu,</span> <span class="pre">roughnessv,</span> <span class="pre">T,</span> <span class="pre">offset)</span></code></li>
</ul>
</div>
<div class="section" id="bssrdf">
<h3>BSSRDF<a class="headerlink" href="#bssrdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bssrdf_cubic(N,</span> <span class="pre">radius,</span> <span class="pre">texture_blur,</span> <span class="pre">sharpness)</span></code></li>
<li><code class="docutils literal"><span class="pre">bssrdf_gaussian(N,</span> <span class="pre">radius,</span> <span class="pre">texture_blur)</span></code></li>
</ul>
</div>
<div class="section" id="volume">
<h3>Volume<a class="headerlink" href="#volume" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">henyey_greenstein(g)</span></code></li>
<li><code class="docutils literal"><span class="pre">absorption()</span></code></li>
</ul>
</div>
<div class="section" id="other">
<h3>其他<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">emission()</span></code></li>
<li><code class="docutils literal"><span class="pre">ambient_occlusion()</span></code></li>
<li><code class="docutils literal"><span class="pre">holdout()</span></code></li>
<li><code class="docutils literal"><span class="pre">background()</span></code></li>
</ul>
</div>
</div>
<div class="section" id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h2>
<p>Some object, particle and mesh attributes are available to the built-in getattribute()
function. UV maps and vertex colors can be retrieved using their name.
其他 attributes are listed below:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">geom:generated</span></code></dt>
<dd>Generated texture coordinates</dd>
<dt><code class="docutils literal"><span class="pre">geom:uv</span></code></dt>
<dd>Default render UV map</dd>
<dt><code class="docutils literal"><span class="pre">geom:dupli_generated</span></code></dt>
<dd>For instances, generated coordinate from duplicator object</dd>
<dt><code class="docutils literal"><span class="pre">geom:dupli_uv</span></code></dt>
<dd>For instances, UV coordinate from duplicator object</dd>
<dt><code class="docutils literal"><span class="pre">geom:trianglevertices</span></code></dt>
<dd>3 vertex coordinates of the triangle</dd>
<dt><code class="docutils literal"><span class="pre">geom:numpolyvertices</span></code></dt>
<dd>Number of vertices in the polygon (always returns three currently)</dd>
<dt><code class="docutils literal"><span class="pre">geom:polyvertices</span></code></dt>
<dd>Vertex coordinates array of the polygon (always three vertices currently)</dd>
<dt><code class="docutils literal"><span class="pre">geom:name</span></code></dt>
<dd>Name of the object</dd>
<dt><code class="docutils literal"><span class="pre">geom:is_curve</span></code></dt>
<dd>Is object a strand or not</dd>
<dt><code class="docutils literal"><span class="pre">geom:curve_intercept</span></code></dt>
<dd>Point along the strand, from root to tip</dd>
<dt><code class="docutils literal"><span class="pre">geom:curve_thickness</span></code></dt>
<dd>厚度 of the strand</dd>
<dt><code class="docutils literal"><span class="pre">geom:curve_tangent_normal</span></code></dt>
<dd>Tangent Normal of the strand</dd>
<dt><code class="docutils literal"><span class="pre">path:ray_length</span></code></dt>
<dd>Ray distance since last hit</dd>
<dt><code class="docutils literal"><span class="pre">object:location</span></code></dt>
<dd>Object location</dd>
<dt><code class="docutils literal"><span class="pre">object:index</span></code></dt>
<dd>Object index number</dd>
<dt><code class="docutils literal"><span class="pre">object:random</span></code></dt>
<dd>Per object random number generated from object index and name</dd>
<dt><code class="docutils literal"><span class="pre">material:index</span></code></dt>
<dd>Material index number</dd>
<dt><code class="docutils literal"><span class="pre">particle:index</span></code></dt>
<dd>Particle instance number</dd>
<dt><code class="docutils literal"><span class="pre">particle:age</span></code></dt>
<dd>Particle age in frames</dd>
<dt><code class="docutils literal"><span class="pre">particle:lifetime</span></code></dt>
<dd>Total lifespan of particle in frames</dd>
<dt><code class="docutils literal"><span class="pre">particle:location</span></code></dt>
<dd>Location of the particle</dd>
<dt><code class="docutils literal"><span class="pre">particle:size</span></code></dt>
<dd>Size of the particle</dd>
<dt><code class="docutils literal"><span class="pre">particle:velocity</span></code></dt>
<dd>Velocity of the particle</dd>
<dt><code class="docutils literal"><span class="pre">particle:angular_velocity</span></code></dt>
<dd>Angular velocity of the particle</dd>
</dl>
</div>
<div class="section" id="trace">
<h2>Trace<a class="headerlink" href="#trace" title="Permalink to this headline">¶</a></h2>
<p>We support the <code class="docutils literal"><span class="pre">trace(point</span> <span class="pre">pos,</span> <span class="pre">vector</span> <span class="pre">dir,</span> <span class="pre">...)</span></code> function, to trace rays from the OSL shader.
The &#8220;shade&#8221; parameter is not supported currently,
but attributes can be retrieved from the object that was hit using the <code class="docutils literal"><span class="pre">getmessage(&quot;trace&quot;,</span> <span class="pre">..)</span></code> function.
See the OSL specification for details on how to use this.</p>
<p>This function cannot be used instead of lighting;
the main purpose is to allow shaders to &#8220;probe&#8221; nearby geometry,
for example to apply a projected texture that can be blocked by geometry,
apply more &#8220;wear&#8221; to exposed geometry, or make other ambient occlusion-like effects.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../world.html" class="btn btn-neutral float-right" title="World" accesskey="n">下一页 <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="converter/wavelength.html" class="btn btn-neutral" title="Wavelength" accesskey="p"><span class="fa fa-arrow-circle-left"></span> 上一页</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright : This page is licensed under a CC-BY-SA 4.0 Intl. License.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'2.77',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1418081-1', 'auto');
  ga('send', 'pageview');

</script>
</div>


</body>
</html>